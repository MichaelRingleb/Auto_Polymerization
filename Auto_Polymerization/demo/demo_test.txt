(autopoly) PS D:\Documents\autopoly\Auto_Polymerization>  d:; cd 'd:\Documents\autopoly\Auto_Polymerization'; & 'c:\Users\AAG Group\miniconda3\envs\autopoly\python.exe' 'c:\Users\AAG Group\.vscode\extensions\ms-python.debugpy-2025.8.0-win32-x64\bundled\libs\debugpy\launcher' '23788' '--' 'D:\Documents\autopoly\Auto_Polymerization\Auto_Polymerization\demo\demo_device_test.py' 
Auto_Polymerization Device Test Demo
============================================================
This demo shows how to test real devices in your platform.
Make sure your hardware is connected and ready before running.

Demo Options:
1. Individual device tests
2. Complete workflow simulation
3. Exit

Select option (1-3): 1
============================================================
DEMO: Individual Device Tests
============================================================
Enter path to your Medusa design JSON file: D:\Documents\autopoly\Auto_Polymerization\Auto_Polymerization\users\config\fluidic_design_autopoly.json
2025-07-09 18:46:10,417 - device_test - INFO - Initializing Medusa with layout: D:\Documents\autopoly\Auto_Polymerization\Auto_Polymerization\users\config\fluidic_design_autopoly.json
2025-07-09 18:46:10,417 - INFO - Initializing Medusa with layout: D:\Documents\autopoly\Auto_Polymerization\Auto_Polymerization\users\config\fluidic_design_autopoly.json
2025-07-09 18:46:10,444 - device_test - INFO - Layout file is valid JSON
2025-07-09 18:46:10,444 - INFO - Layout file is valid JSON
2025-07-09 18:46:10,540 - device_test - INFO - Available COM ports:
2025-07-09 18:46:10,540 - INFO - Available COM ports:
2025-07-09 18:46:10,540 - device_test - INFO -   COM7: USB Serial Port (COM7)
2025-07-09 18:46:10,540 - INFO -   COM7: USB Serial Port (COM7)
2025-07-09 18:46:10,540 - device_test - INFO -   COM14: Prolific PL2303GT USB Serial COM Port (COM14)
2025-07-09 18:46:10,540 - INFO -   COM14: Prolific PL2303GT USB Serial COM Port (COM14)
2025-07-09 18:46:10,541 - device_test - INFO -   COM13: USB Serial Port (COM13)
2025-07-09 18:46:10,541 - INFO -   COM13: USB Serial Port (COM13)
2025-07-09 18:46:10,541 - device_test - INFO -   COM16: USB-Enhanced-SERIAL CH343 (COM16)
2025-07-09 18:46:10,541 - INFO -   COM16: USB-Enhanced-SERIAL CH343 (COM16)
2025-07-09 18:46:10,543 - device_test - INFO -   COM12: USB Serial Device (COM12)
2025-07-09 18:46:10,543 - INFO -   COM12: USB Serial Device (COM12)
2025-07-09 18:46:10,544 - device_test - INFO -   COM3: Intel(R) Active Management Technology - SOL (COM3)
2025-07-09 18:46:10,544 - INFO -   COM3: Intel(R) Active Management Technology - SOL (COM3)
2025-07-09 18:46:10,545 - device_test - INFO -   COM15: USB Serial Port (COM15)
2025-07-09 18:46:10,545 - INFO -   COM15: USB Serial Port (COM15)
Start initializing pump 1
Top speed of plunger on pump on 1 is 384
Valve num of pump on 1 is 5
Initialize valve of pump on 1 succeed.
Home plunger of pump on 1 succeed.
Pump on 1 has been initialized
Start initializing pump 4
Top speed of plunger on pump on 4 is 384
Valve num of pump on 4 is 5
Initialize valve of pump on 4 succeed.
Home plunger of pump on 4 succeed.
Pump on 4 has been initialized
Start initializing pump 2
Top speed of plunger on pump on 2 is 384
Valve num of pump on 2 is 5
Initialize valve of pump on 2 succeed.
Home plunger of pump on 2 succeed.
Pump on 2 has been initialized
Start initializing pump 3
Top speed of plunger on pump on 3 is 384
Valve num of pump on 3 is 5
Initialize valve of pump on 3 succeed.
Home plunger of pump on 3 succeed.
Pump on 3 has been initialized
2025-07-09 18:47:12,367 - INFO - Target temperature set to 0.0.
2025-07-09 18:47:13,444 - INFO - Stop heating.
2025-07-09 18:47:14,523 - INFO - Target rpm set to 0.
2025-07-09 18:47:15,608 - INFO - Stop stirring.
2025-07-09 18:47:15,811 - device_test - INFO - Instantiated a graph with 27 nodes and 35 edges
2025-07-09 18:47:15,811 - INFO - Instantiated a graph with 27 nodes and 35 edges
2025-07-09 18:47:15,811 - device_test - INFO - Loading default settings from package resources: medusa.defaults/GraphDefaults.json        
2025-07-09 18:47:15,811 - INFO - Loading default settings from package resources: medusa.defaults/GraphDefaults.json
2025-07-09 18:47:15,815 - device_test - INFO - Default 'pump' matched category 'Pump'. Using node 'Analytical_Pump'.
2025-07-09 18:47:15,815 - INFO - Default 'pump' matched category 'Pump'. Using node 'Analytical_Pump'.
2025-07-09 18:47:15,816 - device_test - INFO - Default 'gas_reservoir' matched name substring 'Gas'. Using node 'Gas_Reservoir_Vessel'.   
2025-07-09 18:47:15,816 - INFO - Default 'gas_reservoir' matched name substring 'Gas'. Using node 'Gas_Reservoir_Vessel'.
2025-07-09 18:47:15,817 - device_test - INFO - Default 'waste' matched name substring 'Waste'. Using node 'Waste_Vessel'.
2025-07-09 18:47:15,817 - INFO - Default 'waste' matched name substring 'Waste'. Using node 'Waste_Vessel'.
2025-07-09 18:47:15,818 - device_test - INFO - Medusa initialization successful
2025-07-09 18:47:15,818 - INFO - Medusa initialization successful

Demo will test the following devices:
1. Gas valve (open/close cycle)
2. Linear actuator (position changes)
3. UV-VIS spectrometer (reference spectrum)
4. Syringe pump (small transfer)

Proceed with demo? (y/N): 1
Demo cancelled.
Demo Options:
1. Individual device tests
2. Complete workflow simulation
3. Exit

Select option (1-3): 1
============================================================
DEMO: Individual Device Tests
============================================================
Enter path to your Medusa design JSON file: D:\Documents\autopoly\Auto_Polymerization\Auto_Polymerization\users\config\fluidic_design_autopoly.json
2025-07-09 18:47:52,148 - device_test - INFO - Initializing Medusa with layout: D:\Documents\autopoly\Auto_Polymerization\Auto_Polymerization\users\config\fluidic_design_autopoly.json
2025-07-09 18:47:52,148 - INFO - Initializing Medusa with layout: D:\Documents\autopoly\Auto_Polymerization\Auto_Polymerization\users\config\fluidic_design_autopoly.json
2025-07-09 18:47:52,149 - device_test - INFO - Layout file is valid JSON
2025-07-09 18:47:52,149 - INFO - Layout file is valid JSON
2025-07-09 18:47:52,159 - device_test - INFO - Available COM ports:
2025-07-09 18:47:52,159 - INFO - Available COM ports:
2025-07-09 18:47:52,159 - device_test - INFO -   COM7: USB Serial Port (COM7)
2025-07-09 18:47:52,159 - INFO -   COM7: USB Serial Port (COM7)
2025-07-09 18:47:52,159 - device_test - INFO -   COM14: Prolific PL2303GT USB Serial COM Port (COM14)
2025-07-09 18:47:52,159 - INFO -   COM14: Prolific PL2303GT USB Serial COM Port (COM14)
2025-07-09 18:47:52,159 - device_test - INFO -   COM13: USB Serial Port (COM13)
2025-07-09 18:47:52,159 - INFO -   COM13: USB Serial Port (COM13)
2025-07-09 18:47:52,161 - device_test - INFO -   COM16: USB-Enhanced-SERIAL CH343 (COM16)
2025-07-09 18:47:52,161 - INFO -   COM16: USB-Enhanced-SERIAL CH343 (COM16)
2025-07-09 18:47:52,161 - device_test - INFO -   COM12: USB Serial Device (COM12)
2025-07-09 18:47:52,161 - INFO -   COM12: USB Serial Device (COM12)
2025-07-09 18:47:52,161 - device_test - INFO -   COM3: Intel(R) Active Management Technology - SOL (COM3)
2025-07-09 18:47:52,161 - INFO -   COM3: Intel(R) Active Management Technology - SOL (COM3)
2025-07-09 18:47:52,161 - device_test - INFO -   COM15: USB Serial Port (COM15)
2025-07-09 18:47:52,161 - INFO -   COM15: USB Serial Port (COM15)
Start initializing pump 1
Top speed of plunger on pump on 1 is 384
Valve num of pump on 1 is 5
Initialize valve of pump on 1 succeed.
Home plunger of pump on 1 succeed.
Pump on 1 has been initialized
Start initializing pump 4
Top speed of plunger on pump on 4 is 384
Valve num of pump on 4 is 5
Initialize valve of pump on 4 succeed.
Home plunger of pump on 4 succeed.
Pump on 4 has been initialized
Start initializing pump 2
Top speed of plunger on pump on 2 is 384
Valve num of pump on 2 is 5
Initialize valve of pump on 2 succeed.
Home plunger of pump on 2 succeed.
Pump on 2 has been initialized
Start initializing pump 3
Top speed of plunger on pump on 3 is 384
Valve num of pump on 3 is 5
Initialize valve of pump on 3 succeed.
Home plunger of pump on 3 succeed.
Pump on 3 has been initialized
2025-07-09 18:48:54,378 - INFO - Target temperature set to 0.0.
2025-07-09 18:48:55,456 - INFO - Stop heating.
2025-07-09 18:48:56,546 - INFO - Target rpm set to 0.
2025-07-09 18:48:57,628 - INFO - Stop stirring.
2025-07-09 18:48:57,812 - device_test - INFO - Instantiated a graph with 27 nodes and 35 edges
2025-07-09 18:48:57,812 - INFO - Instantiated a graph with 27 nodes and 35 edges
2025-07-09 18:48:57,813 - device_test - INFO - Loading default settings from package resources: medusa.defaults/GraphDefaults.json        
2025-07-09 18:48:57,813 - INFO - Loading default settings from package resources: medusa.defaults/GraphDefaults.json
2025-07-09 18:48:57,816 - device_test - INFO - Default 'pump' matched category 'Pump'. Using node 'Analytical_Pump'.
2025-07-09 18:48:57,816 - INFO - Default 'pump' matched category 'Pump'. Using node 'Analytical_Pump'.
2025-07-09 18:48:57,818 - device_test - INFO - Default 'gas_reservoir' matched name substring 'Gas'. Using node 'Gas_Reservoir_Vessel'.   
2025-07-09 18:48:57,818 - INFO - Default 'gas_reservoir' matched name substring 'Gas'. Using node 'Gas_Reservoir_Vessel'.
2025-07-09 18:48:57,819 - device_test - INFO - Default 'waste' matched name substring 'Waste'. Using node 'Waste_Vessel'.
2025-07-09 18:48:57,819 - INFO - Default 'waste' matched name substring 'Waste'. Using node 'Waste_Vessel'.
2025-07-09 18:48:57,820 - device_test - INFO - Medusa initialization successful
2025-07-09 18:48:57,820 - INFO - Medusa initialization successful

Demo will test the following devices:
1. Gas valve (open/close cycle)
2. Linear actuator (position changes)
3. UV-VIS spectrometer (reference spectrum)
4. Syringe pump (small transfer)

Proceed with demo? (y/N): y

----------------------------------------
TEST 1: Gas Valve
----------------------------------------
2025-07-09 18:49:33,556 - device_test - INFO - Testing gas valve control
2025-07-09 18:49:33,556 - INFO - Testing gas valve control

Proceed with gas valve test? (y/N): y
2025-07-09 18:49:38,204 - device_test - INFO - Opening gas valve...
2025-07-09 18:49:38,204 - INFO - Opening gas valve...
2025-07-09 18:49:38,206 - device_test - ERROR - Gas valve test failed: 'COM12'
2025-07-09 18:49:38,206 - ERROR - Gas valve test failed: 'COM12'
Result: FAIL

----------------------------------------
TEST 2: Linear Actuator
----------------------------------------
2025-07-09 18:49:38,207 - device_test - INFO - Testing linear actuator
2025-07-09 18:49:38,207 - INFO - Testing linear actuator

Proceed with linear actuator test? (y/N): y
2025-07-09 18:49:54,827 - device_test - INFO - Moving actuator to position 1000...
2025-07-09 18:49:54,827 - INFO - Moving actuator to position 1000...
2025-07-09 18:49:54,827 - device_test - ERROR - Linear actuator test failed: 'COM12'
2025-07-09 18:49:54,827 - ERROR - Linear actuator test failed: 'COM12'
Result: FAIL

----------------------------------------
TEST 3: UV-VIS Spectrometer
----------------------------------------
2025-07-09 18:49:54,829 - device_test - INFO - Testing UV-VIS spectrometer
2025-07-09 18:49:54,829 - INFO - Testing UV-VIS spectrometer

Proceed with UV-VIS spectrometer test? (y/N): y
2025-07-09 18:50:01,253 - device_test - INFO - Taking reference spectrum...
2025-07-09 18:50:01,253 - INFO - Taking reference spectrum...
c:\Users\AAG Group\miniconda3\envs\autopoly\lib\site-packages\dll\CCS_DLL\TLCCS_64.dll
2025-07-09 18:50:01,295 - device_test - ERROR - UV-VIS spectrometer test failed: Spectrometer DLL path is wrong, check!
2025-07-09 18:50:01,295 - ERROR - UV-VIS spectrometer test failed: Spectrometer DLL path is wrong, check!
Result: FAIL

----------------------------------------
TEST 4: Syringe Pump
----------------------------------------
2025-07-09 18:50:01,296 - device_test - INFO - Testing syringe pump: Solvent_Monomer_Modification_Pump
2025-07-09 18:50:01,296 - INFO - Testing syringe pump: Solvent_Monomer_Modification_Pump
2025-07-09 18:50:01,296 - device_test - INFO - Transfer 0.5 mL from Solvent_Vessel to Waste_Vessel
2025-07-09 18:50:01,296 - INFO - Transfer 0.5 mL from Solvent_Vessel to Waste_Vessel

Proceed with testing Solvent_Monomer_Modification_Pump? (y/N): y
2025-07-09 18:50:26,281 - device_test - INFO - Transfer 0.5 mL from Solvent_Vessel to Waste_Vessel...
2025-07-09 18:50:26,281 - INFO - Transfer 0.5 mL from Solvent_Vessel to Waste_Vessel...
2025-07-09 18:50:26,287 - device_test - ERROR - Syringe pump test failed: No path between Solvent_Vessel and Solvent_Monomer_Modification_Pump.
2025-07-09 18:50:26,287 - ERROR - Syringe pump test failed: No path between Solvent_Vessel and Solvent_Monomer_Modification_Pump.
Result: FAIL

============================================================
DEMO SUMMARY
============================================================
Tests passed: 0/4
⚠️  Some tests failed. Check the logs for details.
Demo Options:
1. Individual device tests
2. Complete workflow simulation
3. Exit